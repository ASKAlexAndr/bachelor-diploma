\section{Анализ алгоритмов} \label{Dev}

\subsection{Постановка задачи}
COVID-19 - тяжелая респираторная инфекция, вызываемая коронавирусом SARS-CoV-2. На момент написания работы, вспышка вируса, возникщая в китайском городе Ухань, переросла в глобальную пандемию. Основным способом диагностики COVID-19 является метод полимеразной цепной реакции (ПЦР) с обратной транскрипцией, однако это трудоемкий, требующий участия человека процесс. Альтернативой является рентгенологической исследование, например рентген грудной клетки или компьютерная томография (КТ). Исследования показывают, что большинство снимков пациентов с COVID-19 содержат спецефические аномалии, такие как двустороннее ретикулярное узловое затемнение или синдром матового стекла, что позволяет визуально отличить заболевание от других видов пневмоний \cite{wang2020covidnet}. Несмотря на то, что рентген обладает меньшей чуствительностью чем КТ или ПЦР, это гораздо более доступный и быстрый метод диагностики, что является существенным критерием в период пандемии. Решение задачи автоматической диагностики данного заболевания позволит снизить нагрузку на врачей и повысит эффективность их работы.

\addthreeimghere{xray-normal}{Норма}{xray-pneumonia}{Пневмония}{xray-covid}{COVID-19}{Рентгеновские снимки грудных клеток}{xrays}

\subsection{Средства реализации}
cuDNN - библиотека глубоких нейронных сетей от Nvidia позволяющая использовать для вычеслений мощности графического процессора.

Python 3 - гибкий и мощный язык программирования, эффективно выполняющий задачи анализа и обработки данных.

TensorFlow - многофункциональный фреймворк с открытым исходным кодом, разработанный компанией Google, позволяющий проектировать и обучать различные архитектуры нейронных сетей.

Keras - высокоуровневый API для решения задач глубокого машинного обучения, входящий в состав TensorFlow.

% \subsection{Конфигурация системы}
% Все модели были протестированы на системе со следующими характеристиками:
% \begin{itemize}
%   \item Операционная система - Ubuntu 20.04
%   \item Процессор - Intel Core i5 9400F CPU 2.90 Ghz
%   \item Объем оперативной памяти - 8 Гб
%   \item Видеокарта - Nvidia GeForce GTX 1660
% \end{itemize}

\subsection{Обучающая выборка}
Сбор данных для обучения нейронных сетей в задачах такого типа - сложный и долгий процесс, который требует затрат большого количества времени и участие большого количества людей. Поэтому, в качестве источника обучающих и тестовых данных использовались готовые, уже размеченные датасеты: \cite{tawsifurrahman}, \cite{cohen2020covid} и \cite{wang2020covidnet}. 
Всего было получено 13 897 обучающих и 1 579 тестовых изображений.
% Общее количество снимков указано в таблице \ref{inputs}

% \input{thesis/extra/inputs.tex}

% Снимки из обучающей выборки имеют разное разрешение, однако нейронные сети требуют заранее установленное количество входных нейронов. Поэтому, в качестве предварительной обработки данных, все изображения перед подачей на сеть маштабируются к одному разрешению: 512x512 px.

\subsection{Эксперименты и результаты}
В ходе экспериментов были модернизированы для задачи, обучены и протестированы следующие модели нейронных сетей: Inception-V3, ResNet-152 и DenseNet-201. Все модели обучались на общем наборе тренировочных и проверочных данных и с одинаковыми параметрами:
\begin{itemize}
    \item Размер одного пакета подаваемого за одну итерацию на сеть - 8 изображений.
    \item Количество эпох, за которые через сеть проходят все данные - 10.
    \item Категориальная перекрестная энтропия в качестве функции потерь.
\end{itemize}
Точность сетей по метрике accuracy в процессе обучения и тестирования показана на рис. \ref{train-results}. Финальные результаты экспериментов указаны в таблице \ref{test-results}

\addtwoimghere{train_accuracy}{Обучение}{val_accuracy}{Тестирование}{Точность сетей}{train-results}


\input{thesis/extra/test-results.tex}

\clearpage